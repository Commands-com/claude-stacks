<!DOCTYPE html><html class="default" lang="en" data-base="../"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>HookScannerService | claude-stacks</title><meta name="description" content="Documentation for claude-stacks"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => window.app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><a href="../index.html" class="title">claude-stacks</a><div id="tsd-toolbar-links"></div><button id="tsd-search-trigger" class="tsd-widget" aria-label="Search"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></button><dialog id="tsd-search" aria-label="Search"><input role="combobox" id="tsd-search-input" aria-controls="tsd-search-results" aria-autocomplete="list" aria-expanded="true" autocapitalize="off" autocomplete="off" placeholder="Search the docs" maxLength="100"/><ul role="listbox" id="tsd-search-results"></ul><div id="tsd-search-status" aria-live="polite" aria-atomic="true"><div>Preparing search index...</div></div></dialog><a href="#" class="tsd-widget menu" id="tsd-toolbar-menu-trigger" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb" aria-label="Breadcrumb"><li><a href="../modules/services_HookScannerService.html">services/HookScannerService</a></li><li><a href="" aria-current="page">HookScannerService</a></li></ul><h1>Class HookScannerService</h1></div><section class="tsd-panel tsd-comment"><div class="tsd-comment tsd-typography"><p>Service for scanning and analyzing security risks in stack hooks</p>
</div><div class="tsd-comment tsd-typography"><div class="tsd-tag-remarks"><h4 class="tsd-anchor-link" id="remarks">Remarks<a href="#remarks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>This service provides comprehensive security analysis of both file-based and inline hooks
within Claude Stacks. It identifies potentially dangerous patterns, calculates risk scores,
and generates detailed safety reports to help users make informed decisions about stack security.</p>
<p>The service scans for various categories of suspicious patterns including file system operations,
network requests, process execution, credential access, and other potentially harmful activities.
Each pattern is assigned a risk score that contributes to an overall assessment.</p>
</div><div class="tsd-tag-since"><h4 class="tsd-anchor-link" id="since">Since<a href="#since" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>1.4.0</p>
</div></div></section><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/Commands-com/claude-stacks/blob/b1a3c3047c4eab83c5459ab193b3eaffa060c66b/src/services/HookScannerService.ts#L18">src/services/HookScannerService.ts:18</a></li></ul></aside><section class="tsd-panel-group tsd-index-group"><section class="tsd-panel tsd-index-panel"><details class="tsd-index-content tsd-accordion" open><summary class="tsd-accordion-summary tsd-index-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h5 class="tsd-index-heading uppercase">Index</h5></summary><div class="tsd-accordion-details"><section class="tsd-index-section"><h3 class="tsd-index-heading">Constructors</h3><div class="tsd-index-list"><a href="#constructor" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Constructor"><use href="../assets/icons.svg#icon-512"></use></svg><span>constructor</span></a>
</div></section><section class="tsd-index-section"><h3 class="tsd-index-heading">Methods</h3><div class="tsd-index-list"><a href="#calculaterisklevel" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>calculate<wbr/>Risk<wbr/>Level</span></a>
<a href="#generatesafetyreport" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>generate<wbr/>Safety<wbr/>Report</span></a>
<a href="#scanhook" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>scan<wbr/>Hook</span></a>
<a href="#scansettingshooks" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>scan<wbr/>Settings<wbr/>Hooks</span></a>
</div></section></div></details></section></section><details class="tsd-panel-group tsd-member-group tsd-accordion" open><summary class="tsd-accordion-summary" data-key="section-Constructors"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h2>Constructors</h2></summary><section><section class="tsd-panel tsd-member"><h3 class="tsd-anchor-link" id="constructor"><span>constructor</span><a href="#constructor" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class=""><div class="tsd-signature tsd-anchor-link" id="constructorhookscannerservice"><span class="tsd-signature-keyword">new</span> <span class="tsd-kind-constructor-signature">HookScannerService</span><span class="tsd-signature-symbol">()</span><span class="tsd-signature-symbol">:</span> <a href="" class="tsd-signature-type tsd-kind-class">HookScannerService</a><a href="#constructorhookscannerservice" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></div><div class="tsd-description"><h4 class="tsd-returns-title">Returns <a href="" class="tsd-signature-type tsd-kind-class">HookScannerService</a></h4></div></li></ul></section></section></details><details class="tsd-panel-group tsd-member-group tsd-accordion" open><summary class="tsd-accordion-summary" data-key="section-Methods"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h2>Methods</h2></summary><section><section class="tsd-panel tsd-member"><h3 class="tsd-anchor-link" id="calculaterisklevel"><span>calculate<wbr/>Risk<wbr/>Level</span><a href="#calculaterisklevel" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class=""><div class="tsd-signature tsd-anchor-link" id="calculaterisklevel-1"><span class="tsd-kind-call-signature">calculateRiskLevel</span><span class="tsd-signature-symbol">(</span><br/>¬†¬†¬†¬†<span class="tsd-kind-parameter">scanResults</span><span class="tsd-signature-symbol">:</span> <a href="../interfaces/types.HookScanResult.html" class="tsd-signature-type tsd-kind-interface">HookScanResult</a><span class="tsd-signature-symbol">,</span><br/><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">&quot;safe&quot;</span> <span class="tsd-signature-symbol">|</span> <span class="tsd-signature-type">&quot;warning&quot;</span> <span class="tsd-signature-symbol">|</span> <span class="tsd-signature-type">&quot;dangerous&quot;</span><a href="#calculaterisklevel-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></div><div class="tsd-description"><div class="tsd-comment tsd-typography"><p>Calculate the risk level category based on the scan results risk score</p>
<p>Converts the numeric risk score (0-100) into a categorical risk level
for easier interpretation and display. The thresholds are designed to
provide clear guidance on the safety of hook execution.</p>
</div><div class="tsd-parameters"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameter-list"><li><span><span class="tsd-kind-parameter">scanResults</span>: <a href="../interfaces/types.HookScanResult.html" class="tsd-signature-type tsd-kind-interface">HookScanResult</a></span><div class="tsd-comment tsd-typography"><p>The scan results containing the numeric risk score</p>
</div><div class="tsd-comment tsd-typography"></div></li></ul></div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">&quot;safe&quot;</span> <span class="tsd-signature-symbol">|</span> <span class="tsd-signature-type">&quot;warning&quot;</span> <span class="tsd-signature-symbol">|</span> <span class="tsd-signature-type">&quot;dangerous&quot;</span></h4><p>Risk level category: 'safe' (0-29), 'warning' (30-69), or 'dangerous' (70-100)</p>
<div class="tsd-comment tsd-typography"><div class="tsd-tag-throws"><h4 class="tsd-anchor-link" id="throws">Throws<a href="#throws" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Never throws - handles invalid inputs gracefully</p>
</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example">Example<a href="#example" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-10">scanner</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">HookScannerService</span><span class="hl-1">();</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-10">lowRiskResult</span><span class="hl-1"> = { </span><span class="hl-9">riskScore:</span><span class="hl-1"> </span><span class="hl-11">15</span><span class="hl-1">, ... };</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-10">mediumRiskResult</span><span class="hl-1"> = { </span><span class="hl-9">riskScore:</span><span class="hl-1"> </span><span class="hl-11">45</span><span class="hl-1">, ... };</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-10">highRiskResult</span><span class="hl-1"> = { </span><span class="hl-9">riskScore:</span><span class="hl-1"> </span><span class="hl-11">85</span><span class="hl-1">, ... };</span><br/><br/><span class="hl-9">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-9">scanner</span><span class="hl-1">.</span><span class="hl-0">calculateRiskLevel</span><span class="hl-1">(</span><span class="hl-9">lowRiskResult</span><span class="hl-1">)); </span><span class="hl-4">// &#39;safe&#39;</span><br/><span class="hl-9">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-9">scanner</span><span class="hl-1">.</span><span class="hl-0">calculateRiskLevel</span><span class="hl-1">(</span><span class="hl-9">mediumRiskResult</span><span class="hl-1">)); </span><span class="hl-4">// &#39;warning&#39;</span><br/><span class="hl-9">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-9">scanner</span><span class="hl-1">.</span><span class="hl-0">calculateRiskLevel</span><span class="hl-1">(</span><span class="hl-9">highRiskResult</span><span class="hl-1">)); </span><span class="hl-4">// &#39;dangerous&#39;</span>
</code><button type="button">Copy</button></pre>

</div><div class="tsd-tag-since"><h4 class="tsd-anchor-link" id="since-1">Since<a href="#since-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>1.4.0</p>
</div></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/Commands-com/claude-stacks/blob/b1a3c3047c4eab83c5459ab193b3eaffa060c66b/src/services/HookScannerService.ts#L255">src/services/HookScannerService.ts:255</a></li></ul></aside></div></li></ul></section><section class="tsd-panel tsd-member"><h3 class="tsd-anchor-link" id="generatesafetyreport"><span>generate<wbr/>Safety<wbr/>Report</span><a href="#generatesafetyreport" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class=""><div class="tsd-signature tsd-anchor-link" id="generatesafetyreport-1"><span class="tsd-kind-call-signature">generateSafetyReport</span><span class="tsd-signature-symbol">(</span><br/>¬†¬†¬†¬†<span class="tsd-kind-parameter">hooks</span><span class="tsd-signature-symbol">:</span> <a href="../interfaces/types.StackHook.html" class="tsd-signature-type tsd-kind-interface">StackHook</a><span class="tsd-signature-symbol">[]</span><span class="tsd-signature-symbol">,</span><br/>¬†¬†¬†¬†<span class="tsd-kind-parameter">inlineResults</span><span class="tsd-signature-symbol">?:</span> <span class="tsd-signature-type">Map</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">,</span> <a href="../interfaces/types.HookScanResult.html" class="tsd-signature-type tsd-kind-interface">HookScanResult</a><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">,</span><br/><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span><a href="#generatesafetyreport-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></div><div class="tsd-description"><div class="tsd-comment tsd-typography"><p>Generate a comprehensive human-readable safety report for all hooks</p>
<p>Creates a formatted report that summarizes the security analysis of both
file-based hooks and inline hooks. The report includes risk indicators,
suspicious patterns found, and descriptions to help users understand
potential security implications.</p>
</div><div class="tsd-parameters"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameter-list"><li><span><span class="tsd-kind-parameter">hooks</span>: <a href="../interfaces/types.StackHook.html" class="tsd-signature-type tsd-kind-interface">StackHook</a><span class="tsd-signature-symbol">[]</span></span><div class="tsd-comment tsd-typography"><p>Array of file-based stack hooks with their scan results</p>
</div><div class="tsd-comment tsd-typography"></div></li><li><span><code class="tsd-tag">Optional</code><span class="tsd-kind-parameter">inlineResults</span>: <span class="tsd-signature-type">Map</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">,</span> <a href="../interfaces/types.HookScanResult.html" class="tsd-signature-type tsd-kind-interface">HookScanResult</a><span class="tsd-signature-symbol">&gt;</span></span><div class="tsd-comment tsd-typography"><p>Optional map of inline hook scan results from settings analysis</p>
</div><div class="tsd-comment tsd-typography"></div></li></ul></div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">string</span></h4><p>Formatted multi-line string report with risk indicators and pattern details</p>
<div class="tsd-comment tsd-typography"><div class="tsd-tag-throws"><h4 class="tsd-anchor-link" id="throws-1">Throws<a href="#throws-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Never throws - handles missing or malformed data gracefully</p>
</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-1">Example<a href="#example-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-10">scanner</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">HookScannerService</span><span class="hl-1">();</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-10">hooks</span><span class="hl-1"> = [</span><br/><span class="hl-1">  { </span><span class="hl-9">name:</span><span class="hl-1"> </span><span class="hl-2">&#39;setup.py&#39;</span><span class="hl-1">, </span><span class="hl-9">type:</span><span class="hl-1"> </span><span class="hl-2">&#39;PreToolUse&#39;</span><span class="hl-1">, </span><span class="hl-9">scanResults:</span><span class="hl-1"> { </span><span class="hl-9">riskScore:</span><span class="hl-1"> </span><span class="hl-11">75</span><span class="hl-1">, ... } }</span><br/><span class="hl-1">];</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-10">inlineResults</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">Map</span><span class="hl-1">([</span><br/><span class="hl-1">  [</span><span class="hl-2">&#39;PostToolUse[0].inline&#39;</span><span class="hl-1">, { </span><span class="hl-9">riskScore:</span><span class="hl-1"> </span><span class="hl-11">25</span><span class="hl-1">, </span><span class="hl-9">suspiciousPatterns:</span><span class="hl-1"> [</span><span class="hl-2">&#39;networkRequests: 1&#39;</span><span class="hl-1">] }]</span><br/><span class="hl-1">]);</span><br/><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-10">report</span><span class="hl-1"> = </span><span class="hl-9">scanner</span><span class="hl-1">.</span><span class="hl-0">generateSafetyReport</span><span class="hl-1">(</span><span class="hl-9">hooks</span><span class="hl-1">, </span><span class="hl-9">inlineResults</span><span class="hl-1">);</span><br/><span class="hl-9">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-9">report</span><span class="hl-1">);</span><br/><span class="hl-4">// Output:</span><br/><span class="hl-4">// üìÑ File-based hooks:</span><br/><span class="hl-4">//   üî¥ setup.py (PreToolUse)</span><br/><span class="hl-4">//     ‚Ä¢ fileSystemDelete: 2 occurrence(s)</span><br/><span class="hl-4">//</span><br/><span class="hl-4">// üìù Inline hooks:</span><br/><span class="hl-4">//   ‚ö†Ô∏è PostToolUse[0].inline (risk: 25)</span><br/><span class="hl-4">//     ‚Ä¢ networkRequests: 1 occurrence(s)</span>
</code><button type="button">Copy</button></pre>

</div><div class="tsd-tag-since"><h4 class="tsd-anchor-link" id="since-2">Since<a href="#since-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>1.4.0</p>
</div></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/Commands-com/claude-stacks/blob/b1a3c3047c4eab83c5459ab193b3eaffa060c66b/src/services/HookScannerService.ts#L297">src/services/HookScannerService.ts:297</a></li></ul></aside></div></li></ul></section><section class="tsd-panel tsd-member"><h3 class="tsd-anchor-link" id="scanhook"><span>scan<wbr/>Hook</span><a href="#scanhook" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class=""><div class="tsd-signature tsd-anchor-link" id="scanhook-1"><span class="tsd-kind-call-signature">scanHook</span><span class="tsd-signature-symbol">(</span><span class="tsd-kind-parameter">content</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">:</span> <a href="../interfaces/types.HookScanResult.html" class="tsd-signature-type tsd-kind-interface">HookScanResult</a><a href="#scanhook-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></div><div class="tsd-description"><div class="tsd-comment tsd-typography"><p>Scan a hook's content for potentially dangerous patterns and security risks</p>
<p>Analyzes the provided hook content against a comprehensive set of dangerous patterns
including file system operations, network access, process execution, credential access,
and other security-sensitive operations. Returns a detailed analysis with risk flags
and an overall risk score.</p>
</div><div class="tsd-parameters"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameter-list"><li><span><span class="tsd-kind-parameter">content</span>: <span class="tsd-signature-type">string</span></span><div class="tsd-comment tsd-typography"><p>The hook code content to analyze for security risks</p>
</div><div class="tsd-comment tsd-typography"></div></li></ul></div><h4 class="tsd-returns-title">Returns <a href="../interfaces/types.HookScanResult.html" class="tsd-signature-type tsd-kind-interface">HookScanResult</a></h4><p>A comprehensive scan result containing risk flags, suspicious patterns, and risk score</p>
<div class="tsd-comment tsd-typography"><div class="tsd-tag-throws"><h4 class="tsd-anchor-link" id="throws-2">Throws<a href="#throws-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Never throws - all parsing errors are handled gracefully</p>
</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-2">Example<a href="#example-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-10">scanner</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">HookScannerService</span><span class="hl-1">();</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-10">result</span><span class="hl-1"> = </span><span class="hl-9">scanner</span><span class="hl-1">.</span><span class="hl-0">scanHook</span><span class="hl-1">(</span><span class="hl-2">&#39;import subprocess; subprocess.run(&quot;rm -rf /&quot;)&#39;</span><span class="hl-1">)</span><br/><span class="hl-9">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-9">result</span><span class="hl-1">.</span><span class="hl-9">riskScore</span><span class="hl-1">); </span><span class="hl-4">// High risk score due to dangerous patterns</span><br/><span class="hl-9">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-9">result</span><span class="hl-1">.</span><span class="hl-9">hasProcessExecution</span><span class="hl-1">); </span><span class="hl-4">// true</span><br/><span class="hl-9">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-9">result</span><span class="hl-1">.</span><span class="hl-9">hasFileSystemAccess</span><span class="hl-1">); </span><span class="hl-4">// true</span>
</code><button type="button">Copy</button></pre>

</div><div class="tsd-tag-since"><h4 class="tsd-anchor-link" id="since-3">Since<a href="#since-3" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>1.4.0</p>
</div></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/Commands-com/claude-stacks/blob/b1a3c3047c4eab83c5459ab193b3eaffa060c66b/src/services/HookScannerService.ts#L59">src/services/HookScannerService.ts:59</a></li></ul></aside></div></li></ul></section><section class="tsd-panel tsd-member"><h3 class="tsd-anchor-link" id="scansettingshooks"><span>scan<wbr/>Settings<wbr/>Hooks</span><a href="#scansettingshooks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class=""><div class="tsd-signature tsd-anchor-link" id="scansettingshooks-1"><span class="tsd-kind-call-signature">scanSettingsHooks</span><span class="tsd-signature-symbol">(</span><span class="tsd-kind-parameter">settings</span><span class="tsd-signature-symbol">:</span> <a href="../interfaces/types.StackSettings.html" class="tsd-signature-type tsd-kind-interface">StackSettings</a><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">Map</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">,</span> <a href="../interfaces/types.HookScanResult.html" class="tsd-signature-type tsd-kind-interface">HookScanResult</a><span class="tsd-signature-symbol">&gt;</span><a href="#scansettingshooks-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></div><div class="tsd-description"><div class="tsd-comment tsd-typography"><p>Scan all inline hooks within stack settings for security risks</p>
<p>Traverses the stack settings to find and analyze all inline hook code snippets.
This includes hooks defined directly in the settings configuration as well as
nested hooks within matcher configurations. Each discovered inline hook is
scanned using the same security analysis as file-based hooks.</p>
</div><div class="tsd-parameters"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameter-list"><li><span><span class="tsd-kind-parameter">settings</span>: <a href="../interfaces/types.StackSettings.html" class="tsd-signature-type tsd-kind-interface">StackSettings</a></span><div class="tsd-comment tsd-typography"><p>Stack settings object that may contain inline hook configurations</p>
</div><div class="tsd-comment tsd-typography"></div></li></ul></div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Map</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">,</span> <a href="../interfaces/types.HookScanResult.html" class="tsd-signature-type tsd-kind-interface">HookScanResult</a><span class="tsd-signature-symbol">&gt;</span></h4><p>A map where keys are hook paths (e.g., &quot;PreToolUse[0].inline&quot;) and values are scan results</p>
<div class="tsd-comment tsd-typography"><div class="tsd-tag-throws"><h4 class="tsd-anchor-link" id="throws-3">Throws<a href="#throws-3" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Never throws - malformed settings are handled gracefully</p>
</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-3">Example<a href="#example-3" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-10">scanner</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">HookScannerService</span><span class="hl-1">();</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-10">settings</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-9">hooks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-9">PreToolUse:</span><span class="hl-1"> [{ </span><span class="hl-9">code:</span><span class="hl-1"> </span><span class="hl-2">&#39;console.log(&quot;safe&quot;)&#39;</span><span class="hl-1"> }],</span><br/><span class="hl-1">    </span><span class="hl-9">PostToolUse:</span><span class="hl-1"> [{ </span><span class="hl-9">code:</span><span class="hl-1"> </span><span class="hl-2">&#39;subprocess.run(&quot;dangerous&quot;)&#39;</span><span class="hl-1"> }]</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-10">results</span><span class="hl-1"> = </span><span class="hl-9">scanner</span><span class="hl-1">.</span><span class="hl-0">scanSettingsHooks</span><span class="hl-1">(</span><span class="hl-9">settings</span><span class="hl-1">);</span><br/><span class="hl-9">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-9">results</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">&quot;PreToolUse[0].inline&quot;</span><span class="hl-1">)?.</span><span class="hl-9">riskScore</span><span class="hl-1">); </span><span class="hl-4">// Low risk</span><br/><span class="hl-9">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-9">results</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">&quot;PostToolUse[0].inline&quot;</span><span class="hl-1">)?.</span><span class="hl-9">riskScore</span><span class="hl-1">); </span><span class="hl-4">// High risk</span>
</code><button type="button">Copy</button></pre>

</div><div class="tsd-tag-since"><h4 class="tsd-anchor-link" id="since-4">Since<a href="#since-4" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>1.4.0</p>
</div></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/Commands-com/claude-stacks/blob/b1a3c3047c4eab83c5459ab193b3eaffa060c66b/src/services/HookScannerService.ts#L150">src/services/HookScannerService.ts:150</a></li></ul></aside></div></li></ul></section></section></details></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h3>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h3>On This Page</h3></summary><div class="tsd-accordion-details"><details open class="tsd-accordion tsd-page-navigation-section"><summary class="tsd-accordion-summary" data-key="section-Constructors"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Constructors</summary><div><a href="#constructor"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Constructor"><use href="../assets/icons.svg#icon-512"></use></svg><span>constructor</span></a></div></details><details open class="tsd-accordion tsd-page-navigation-section"><summary class="tsd-accordion-summary" data-key="section-Methods"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Methods</summary><div><a href="#calculaterisklevel"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>calculate<wbr/>Risk<wbr/>Level</span></a><a href="#generatesafetyreport"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>generate<wbr/>Safety<wbr/>Report</span></a><a href="#scanhook"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>scan<wbr/>Hook</span></a><a href="#scansettingshooks"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>scan<wbr/>Settings<wbr/>Hooks</span></a></div></details></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">claude-stacks</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
